(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{187:function(t,e,n){"use strict";n.r(e),n.d(e,"SurveyDefault",(function(){return C}));var i=n(10),s=n(1),a=n(81),r=n(7),l=n(5),c=n(82),o=n(8),u=n(4);function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function d(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){p(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function p(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function b(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,i=g(t);if(e){var s=g(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return S(this,n)}}function S(t,e){return!e||"object"!==_(e)&&"function"!=typeof e?A(t):e}function A(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var C=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(h,t);var e,n,s,_=b(h);function h(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(n=_.call(this,t,e)).form_=null,n.isEnabled_=!1,n.isStarted_=!1,n.wasSubmitted_=!1,n.alertElement_=null,n.nextBtn_=null,n.backBtn_=null,n.currentPanel_=null,n.currentPanelConfig_={},n.currentPanelFilled_=null,n.currentInputs_=[],n.panelContainer_=null,n.previousPanel_=null,n.nextPanel_=null,n.configAnalytics_=Object(r.a)(n.element,"data-g-config"),n.moduleName_=n.configAnalytics_.moduleName||"",n.currentSelectedInputs_=[],n.baseConfigAnalytics_={eventCategory:L.SURVEY_NAME,moduleName:n.moduleName_},n.panelIndex_=0,n.indexQuestionList_=[],n.indexQuestion_=0,n.panelsLength_=0,n.dao_=c.a.get("persistent"),n.xhr_=null,n.formData_=null,n.submitRetries_=n.config_.retries||0,n.registerSurvey_=n.registerSurvey_.bind(A(n)),n.enableSurvey_=n.enableSurvey_.bind(A(n)),n.onKeydown_=n.onKeydown_.bind(A(n)),n.handleCloseSurveyAnalytics_=n.handleCloseSurveyAnalytics_.bind(A(n)),n.closeSurvey_=n.closeSurvey_.bind(A(n)),n.handleReadyStateChange_=n.handleReadyStateChange_.bind(A(n)),n}return e=h,(n=[{key:"initialize_",value:function(){var t=this;this.dao_.read(L.OPTOUT)||(this.getSurveyElements_(),this.events=p({},"click ".concat(m.PANEL_SUBMITTED_CTA),(function(){t.closeSurvey_(t.config_.id)})),this.nextBtn_.addEventListener("click",(function(e){return t.changePanel_(e)})),this.backBtn_.addEventListener("click",(function(e){t.changePanel_(e,!1),t.handBackEventAnalytics_()})),this.subscriptions_=[[this.topics_.SHOW_SURVEY,this.enableSurvey_],[this.topics_.CLOSE_SURVEY,this.closeSurvey_]],this.updatePanel_(),this.setUiClass_(),this.panelsLength_=f(this.element.querySelectorAll(m.SURVEY_PANEL)).length,this.indexQuestionList_=this.config_.indexQuestionList||[],this.registerSurvey_())}},{key:"registerSurvey_",value:function(){this.store_.dispatch(this.topics_.REGISTER_SURVEY,{id:this.config_.id,data:this.config_.data}),this.handleLaunchForAnalytics_(0)}},{key:"getSurveyElements_",value:function(){this.form_=this.element.querySelector(m.FORM),this.alertElement_=this.element.querySelector(m.ALERT),this.nextBtn_=this.element.querySelector(m.NEXT),this.backBtn_=this.element.querySelector(m.BACK),this.panelContainer_=this.element.querySelector(m.PANEL_CONTAINER),this.currentPanel_=this.element.querySelector(m.PANEL_VISIBLE),this.currentPanelConfig_=Object(r.a)(this.currentPanel_,"data-p-config"),this.currentPanelFilled_=Object(r.a)(this.currentPanel_,"data-p-filled"),this.nextPanel_=this.currentPanel_.nextElementSibling}},{key:"enableSurvey_",value:function(t){t===this.config_.id&&(this.isEnabled_=!0)}},{key:"changePanel_",value:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t.preventDefault(),this.isEnabled_)if(this.currentSelectedInputs_=this.getSelectedInputs_(),this.handlePanelAnalytics_(),!n&&this.currentPanelConfig_.ctas.back.action===L.CLOSE||n&&this.currentPanelConfig_.ctas.next.action===L.CLOSE)this.closeSurvey_(this.config_.id);else if(!n||this.currentPanelFilled_){var s=600,a=this.currentPanel_;this.alertElement_.classList.remove(T.VISIBLE),this.panelContainer_.classList.add(T.FADE),this.setUiClass_(!1),this.currentPanelConfig_.submit&&this.sendData_(),this.currentPanel_=n?this.nextPanel_:this.previousPanel_,this.currentPanelConfig_=Object(r.a)(this.currentPanel_,"data-p-config"),this.currentPanelFilled_=Object(r.a)(this.currentPanel_,"data-p-filled"),this.currentInputs_=f(this.currentPanel_.querySelectorAll(m.INPUT)),this.nextPanel_=this.currentPanel_.nextElementSibling,this.previousPanel_=this.currentPanel_.previousElementSibling,i.a.requestTimeout((function(){e.currentPanelConfig_.centered?e.panelContainer_.classList.add(T.CENTERED):e.panelContainer_.classList.remove(T.CENTERED),a.classList.remove(T.VISIBLE),e.currentPanel_.classList.add(T.VISIBLE),e.panelContainer_.classList.remove(T.FADE)}),s),this.setUiClass_(),this.updatePanel_(),this.handlePanelFilled_()}else this.alertElement_.classList.add(T.VISIBLE)}},{key:"updatePanel_",value:function(){this.isStarted_||"full-height"!==this.currentPanelConfig_.type||(this.isStarted_=!0,this.element.classList.add(T.FULL_HEIGHT),this.store_.dispatch(this.topics_.START_SURVEY,{id:this.config_.id}),document.addEventListener("keydown",this.onKeydown_)),this.updateCta_(this.nextBtn_,this.currentPanelConfig_.ctas.next),this.updateCta_(this.backBtn_,this.currentPanelConfig_.ctas.back),this.enableCurrentInputs_(),this.setInputListeners_(),this.panelIndex_=this.currentPanelConfig_.index}},{key:"closeSurvey_",value:function(t){t===this.config_.id&&this.isEnabled_&&(this.isEnabled_=!1,this.element.classList.remove(T.FULL_HEIGHT),document.removeEventListener("keydown",this.onKeydown_),this.store_.dispatch(this.topics_.CLOSE_SURVEY,{id:this.config_.id}),this.optoutUser_(),event.target!==this.backBtn_&&this.handleCloseSurveyAnalytics_({},this.config_.id))}},{key:"setUiClass_",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t?this.element.classList.add("".concat(T.SURVEY_UI,"-").concat(this.currentPanel_.dataset.panel)):this.element.classList.remove("".concat(T.SURVEY_UI,"-").concat(this.currentPanel_.dataset.panel))}},{key:"onKeydown_",value:function(t){t.keyCode===a.a.ESC&&this.closeSurvey_(this.config_.id)}},{key:"updateCta_",value:function(t,e){e.display?(t.classList.remove(T.HIDDEN),t.tabIndex=0):(t.classList.add(T.HIDDEN),t.tabIndex=-1),t.innerHTML=e.text}},{key:"setInputListeners_",value:function(){var t=this;this.currentInputs_.forEach((function(e){e.addEventListener("change",(function(){t.handlePanelFilled_()}))}))}},{key:"getSelectedInputs_",value:function(){return this.currentInputs_.filter((function(t){return!0===t.checked}))}},{key:"handleLaunchForAnalytics_",value:function(t){if(this.isEnabled_){var e=Object(r.a)(this.element,"data-g-config"),n=this.indexQuestionList_[t]||t;switch(t){case 0:e.eventLabel=L.LAUNCHED;break;case this.panelsLength_-1:e.eventLabel=L.THANK_YOU;break;default:e.eventLabel="Question ".concat(n)}this.store_.dispatch(this.topics_.GA_TRACK_EVENT,{data:e,id:o.a.AUTOMATED_INTERACTION})}}},{key:"handleSelectedInputsAnalytics_",value:function(){var t=this.panelIndex_>0&&this.panelIndex_<this.panelsLength_,e=this.currentSelectedInputs_.map((function(t){return t.value}))||[],n=e.join(" - ");if(e.length){e.push(n);var i={eventAction:"question ".concat(this.indexQuestion_," ").concat(L.RESPONSE),eventLabel:n};t&&e.length&&this.store_.dispatch(this.topics_.GA_TRACK_EVENT,{data:d(d({},this.baseConfigAnalytics_),i),id:o.a.AUTOMATED_INTERACTION})}}},{key:"setCloseConfigAnalytics_",value:function(t){var e=this.setCloseDataAnalytics_();t.setAttribute("data-g-config",JSON.stringify(e))}},{key:"handleCloseSurveyAnalytics_",value:function(t,e){var n=this.setCloseDataAnalytics_();this.store_.dispatch(this.topics_.GA_TRACK_EVENT,{data:n,id:o.a.AUTOMATED_INTERACTION})}},{key:"setCloseDataAnalytics_",value:function(){var t=this.baseConfigAnalytics_;return Object.assign(t,{eventLabel:L.CLOSED,eventAction:L.CLOSE}),t}},{key:"handlePanelAnalytics_",value:function(){this.indexQuestion_=this.indexQuestionList_[this.panelIndex_]||this.panelIndex_,this.handleStartEventAnalytics_(),this.handleNextEventAnalytics_(),this.handleSelectedInputsAnalytics_()}},{key:"handleStartEventAnalytics_",value:function(){var t=!this.panelIndex_,e=this.panelIndex_===this.panelsLength_-2,n=event&&event.target===this.backBtn_,i={eventLabel:L.CLOSE,eventAction:L.START},s={eventLabel:L.START_LABEL,eventAction:L.START},a=this.baseConfigAnalytics_;n||(t?(a=d(d({},a),s),this.handleLaunchForAnalytics_(1)):e&&(a=d(d({},a),i)),(t||e)&&this.store_.dispatch(this.topics_.GA_TRACK_EVENT,{data:a,id:o.a.AUTOMATED_INTERACTION}))}},{key:"handleNextEventAnalytics_",value:function(){var t=event.target,e=(this.currentPanelConfig_.ctas.next.action||"").toLowerCase()===L.NEXT&&this.panelIndex_,n=this.setQuestionDataAnalytics_(this.panelIndex_-2,L.NEXT)||{};t===this.nextBtn_&&(e&&this.currentPanelFilled_&&this.handleLaunchForAnalytics_(this.panelIndex_+1),e&&this.store_.dispatch(this.topics_.GA_TRACK_EVENT,{data:n,id:o.a.AUTOMATED_INTERACTION}))}},{key:"handBackEventAnalytics_",value:function(){var t=this.setQuestionDataAnalytics_(this.panelIndex_+1,L.BACK);this.panelIndex_?(this.backBtn_.setAttribute("data-g-config",JSON.stringify(t)),this.handleLaunchForAnalytics_(this.panelIndex_)):this.handleCloseSurveyAnalytics_()}},{key:"setQuestionDataAnalytics_",value:function(t,e){var n,i={eventLabel:e,eventAction:""},s=t;return e===L.NEXT&&(s+=2),n=this.indexQuestionList_[s]||s,i.eventAction="question ".concat(n," ").concat(L.CLICK),d(d({},this.baseConfigAnalytics_),i)}},{key:"enableCurrentInputs_",value:function(){this.currentInputs_.forEach((function(t){t.tabIndex=0}))}},{key:"handlePanelFilled_",value:function(){var t=!0;this.currentInputs_.length&&(t=this.currentInputs_.some((function(t){return!0===t.checked}))),this.currentPanelFilled_=t,t&&this.alertElement_.classList.remove(T.VISIBLE),this.currentPanel_.setAttribute("dataPFilled",t)}},{key:"optoutUser_",value:function(){this.dao_.save(L.OPTOUT,"true")}},{key:"valdidateDataTosend_",value:function(){!this.wasSubmitted_&&this.isEnabled_&&(this.wasSubmitted_=!0,this.store_.dispatch(this.topics_.SUBMIT_SURVEY,{id:this.config_.id}))}},{key:"sendData_",value:function(){this.valdidateDataTosend_(),this.formData_=new FormData(this.form_),this.submitData_()}},{key:"submitData_",value:function(){this.xhr_=new XMLHttpRequest,this.xhr_.onreadystatechange=this.handleReadyStateChange_,this.xhr_.open("POST",this.config_.endpoint,!0),this.xhr_.send(this.formData_)}},{key:"handleReadyStateChange_",value:function(){if(this.xhr_&&4===this.xhr_.readyState)if(200===this.xhr_.status)this.optoutUser_(),Object(l.a)(event.target.responseText);else{if(0===this.submitRetries_)throw new u.l;this.submitRetries_--,this.submitData_()}}}])&&v(e.prototype,n),s&&v(e,s),h}(s.BaseComponent),L={BACK:"back",CLICK:"click",CLOSE:"close",CLOSED:"closed",LAUNCHED:"launched",NEXT:"next",OPTOUT:"optout-survey",RESPONSE:"response",SURVEY_NAME:"survey",START:"start",START_LABEL:"get started",THANK_YOU:"thank you"},T={CENTERED:"centered",FADE:"fade",FULL_HEIGHT:"full-height",HIDDEN:"hidden",SURVEY_UI:"survey-default__ui",VISIBLE:"is-visible"},m={ALERT:".survey-default__alert",BACK:".survey-default__cta-back",FORM:".survey-default__form",INPUT:"input",NEXT:".survey-default__cta-next",PANEL_VISIBLE:".survey-panel.is-visible",PANEL_CONTAINER:".survey-default__panel-container",PANEL_SUBMITTED_CTA:".survey-panel--end__cta",SURVEY_PANEL:".survey-panel",TEXTAREA:"textarea"}},25:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i={DOWN:40,END:35,ENTER:13,ESC:27,HOME:36,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38}},81:function(t,e,n){"use strict";var i=n(25);n.d(e,"a",(function(){return i.a}))}}]);